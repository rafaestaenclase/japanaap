<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no" />
<title>√Ålbum de Gatos | „Å≠„Åì„Ç¢„É´„Éê„É†</title>
<style>
  :root{
    --bg:#fff5f7;           /* rosa sakura muy suave */
    --card:#ffffff;
    --ink:#40323a;
    --accent:#ff7aa2;       /* sakura */
    --accent-2:#ffd1e0;
    --accent-3:#fff0f5;
    --pill:#ffe3ee;
    --tab:#ff9ab8;
    --tab-ghost:#ffd6e5;
    --shadow: 0 8px 24px rgba(255,122,162,.25);
    --radius:20px;
  }

  *{box-sizing:border-box}
  body{
    margin:0;
    font-family: ui-rounded, "Hiragino Maru Gothic ProN", "Noto Sans JP", system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
    color:var(--ink);
    background:
      radial-gradient(20px 20px at 20% 10%, #ffe9f2 30%, transparent 31%) repeat,
      linear-gradient(#fff, #fff) padding-box,
      var(--bg);
    background-size: 60px 60px, auto, auto;
    min-height:100dvh;
  }

  header{
    position:sticky; top:0; z-index:5;
    background: rgba(255,245,247,.8);
    backdrop-filter: blur(6px);
    border-bottom: 1px dashed #ffc0d4;
  }


.menu-overlay {
  position: fixed;
  inset: 0;
  background: var(--bg);
  z-index: 100;
  display: flex;
  flex-direction: column;
  padding: 5px 10px;
  overflow-y: auto;

  /* Inicial abierto */
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
  transition: opacity 0.35s cubic-bezier(0.23, 1, 0.32, 1),
              transform 0.35s cubic-bezier(0.23, 1, 0.32, 1);
}

.menu-overlay.close {
  opacity: 0;
  transform: translateY(-30px) scale(0.95);
  pointer-events: none;
}


.menu-overlay .close-btn {
  align-self: flex-start;
  background: var(--accent);
  color: #fff;
  border: none;
  padding: 5px 10px;
  border-radius: 12px;
  cursor: pointer;
}

  .container{
    max-width: 1100px;
    padding: 18px 16px 28px;
    margin: 0 auto;
  }

  .title{
    display: flex;
    align-items: center;
    gap: .6rem;
    margin: 0 0 10px;
    font-weight: 800;
    letter-spacing: .5px;
    justify-content: space-between;
  }
  .title { font-size:1.6rem }

  /* Tabs categor√≠as */
  .tabs{
    display:flex; gap:10px; flex-wrap:wrap; margin: 10px 0 18px;
  }
  .tab{
    padding:10px 14px;
    border-radius:999px;
    background:var(--tab-ghost);
    color:#6b4a56;
    font-weight:700;
    cursor:pointer;
    border:2px solid transparent;
    box-shadow: 0 2px 0 #ffe1ee inset;
    user-select:none;
    transition: transform .08s ease, background .2s ease, border-color .2s;
  }
  .tab:hover{ transform: translateY(-1px) }
  .tab.active{
    background: var(--tab);
    color:#fff;
    border-color:#ff6c9a;
  }

  /* Barra info + paginaci√≥n */
  .bar{
    display:flex; justify-content:space-between; align-items:center;
    gap:12px; margin: 8px 0 16px;
  }
  .badge{
    background:var(--pill);
    color:#7a4e5d;
    padding:8px 12px;
    border-radius:999px;
    font-weight:700;
    box-shadow: var(--shadow);
  }
  .pager{
    display:flex; align-items:center; gap:8px;
  }
  .btn{
    border:none; cursor:pointer; font-weight:800;
    padding:10px 14px; border-radius:12px;
    background: var(--accent);
    color:#fff;
    box-shadow: var(--shadow);
    transition: transform .07s ease, opacity .2s ease, background .2s ease;
  }
  .btn.ghost{ background:var(--accent-2); color:#613b47 }
  .btn:disabled{ opacity:.4; cursor:not-allowed }
  .btn:active{ transform: translateY(1px) }

  /* Grid miniaturas */
  .grid{
    display:grid;
    grid-template-columns: repeat(2, 1fr);
    gap:14px;
  }
  @media (min-width: 640px){
    .grid{ grid-template-columns: repeat(3, 1fr) }
  }
  @media (min-width: 900px){
    .grid{ grid-template-columns: repeat(4, 1fr) }
  }

  .card{
    background:var(--card);
    border-radius: var(--radius);
    overflow:hidden;
    box-shadow: var(--shadow);
    border: 2px solid #ffe1ee;
    transition: transform .1s ease, box-shadow .2s ease;
    position:relative;
  }
  .card:hover{ transform: translateY(-2px); box-shadow: 0 12px 28px rgba(255,122,162,.28) }
  .thumb{
    width:100%; aspect-ratio: 1/1; object-fit: cover; display:block;
    background:#f9d9e5;
  }
  .cap{
    padding:10px 12px; font-weight:700; font-size:.95rem;
    display:flex; justify-content:space-between; align-items:center; gap:8px;
  }
  .lock{
    position:absolute; inset:0; display:grid; place-items:center;
    background: repeating-linear-gradient(45deg, rgba(0,0,0,.05) 0 6px, rgba(0,0,0,.08) 6px 12px);
    color:#000; font-size:2rem;
  }

  /* Modal visor */
  .lightbox{
    position:fixed; inset:0; z-index:50; display:none;
    background: rgba(0,0,0,.5);
  }
  .lightbox.open{ display:block; }
  .viewer{
    position:absolute; inset:0; display:grid; place-items:center; padding:20px;
  }
  .frame{
    position:relative; background:#fff; border-radius:24px; overflow:hidden;
    max-width: min(92vw, 860px); width:100%;
    box-shadow: 0 40px 80px rgba(0,0,0,.35);
  }
  .frame img{
    width:100%; max-height: min(78dvh, 70vh); object-fit:contain; background:#111;
  }
  .frame .title{
    margin:0; padding:10px 14px 14px; font-size:1.1rem; justify-content:space-between;
  }
  .close, .nav{
    position:absolute; top:10px; background: rgba(255,255,255,.9);
    border:none; border-radius:12px; padding:10px 12px; font-weight:900; cursor:pointer;
    box-shadow: var(--shadow);
  }
  .close{ right:10px }
  .nav.prev{ left:10px; top:50%; transform: translateY(-50%) }
  .nav.next{ right:10px; top:50%; transform: translateY(-50%) }

  /* Silueta de gato (SVG) por defecto */
  .placeholder{
    display:grid; place-items:center; background:#111; color:#fff;
    aspect-ratio:1/1;
  }
  .placeholder svg{ width:60%; height:auto; opacity:.9; }
</style>
</head>
<body>

  <header>
    <button id="menuBtn" class="btn ghost">üìÇ Categor√≠as</button>
    <span id="currentCategory" style="margin-left:1rem; font-weight:700; color:#ff6c9a;"></span>
  </header>


  <div id="menuOverlay" class="menu-overlay">
    <h1 class="title">
      <span class="ja">„Å≠„Åì„Ç¢„É´„Éê„É† <br>√Ålbum de Gatos</span>
      <button class="close-btn" id="closeMenu">Cerrar √Ålbum</button>
    </h1>
    
    <div class="tabs" id="tabs"></div>
  </div>

  <main class="container">
    <div class="bar">
      <div class="pager">
        <button class="btn ghost" id="prevPage">‚Üê Anterior</button>
        <span id="pageInfo" class="badge">P√°gina 1/1</span>
        <button class="btn" id="nextPage">Siguiente ‚Üí</button>
      </div>
    </div>

    <section class="grid" id="grid"></section>
  </main>

  <!-- Lightbox / Visor -->
  <div class="lightbox" id="lightbox" aria-hidden="true">
    <div class="viewer" id="viewer">
      <div class="frame" id="frame">
        <button class="close" id="btnClose" aria-label="Cerrar">√ó</button>
        <button class="nav prev" id="btnPrev" aria-label="Anterior">‚Äπ</button>
        <img id="fullImg" alt="Gato" />
        <button class="nav next" id="btnNext" aria-label="Siguiente">‚Ä∫</button>
        <div class="title"><span id="fullCaption">‚Äî</span><span>üêæ</span></div>
      </div>
    </div>
  </div>
<script src="./js/catsList.js"></script>
<script>
/* ============================
   Datos de ejemplo (puedes reemplazar por tu localStorage)
   ============================ */
const PLACEHOLDER_SVG = `
  <svg viewBox="0 0 256 256" fill="currentColor" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
    <path d="M66 70c-8-19-26-30-38-32 6 14 7 29 5 42-3 17-14 38-14 57 0 53 47 91 109 91s109-38 109-91c0-19-11-40-14-57-2-13-1-28 5-42-12 2-30 13-38 32-13-8-31-12-62-12s-49 4-62 12zM96 140a12 12 0 11-12-12 12 12 0 0112 12zm88-12a12 12 0 1012 12 12 12 0 00-12-12z"/>
  </svg>
`;

/* ============================
   Estado
   ============================ */
let currentCat = CATEGORIES[0].id;
let page = 1;
const PAGE_SIZE = 8;
let currentList = [];
let lightIndex = 0;

/* ============================
   Helpers UI
   ============================ */
const $ = s => document.querySelector(s);
const grid = $("#grid");
const tabs = $("#tabs");
const badge = $("#badge");
const pageInfo = $("#pageInfo");
const prevPage = $("#prevPage");
const nextPage = $("#nextPage");

function makeTabs(){
  tabs.innerHTML = "";
  CATEGORIES.forEach(c => {
    const b = document.createElement("button");
    b.className = "tab" + (c.id===currentCat ? " active":"");
    b.textContent = c.label;
    b.addEventListener("click", ()=>{
      currentCat = c.id;
      page = 1;
      render();
      menuOverlay.classList.add("close"); // cerrar overlay al seleccionar
    });
    tabs.appendChild(b); // usamos el mismo #tabs dentro del overlay
  });
}

function paginate(list, page, size){
  const totalPages = Math.max(1, Math.ceil(list.length / size));
  const start = (page-1)*size;
  return {
    totalPages,
    items: list.slice(start, start+size)
  };
}

function render(){
  // actualizar tabs activas
  [...tabs.children].forEach(x=>{
    x.classList.toggle("active", x.textContent === CATEGORIES.find(c=>c.id===currentCat).label);
  });

  // Obtener gatos guardados en localStorage
  let savedCats = [];
  try {
    const raw = localStorage.getItem("catsInAlbum");
    if (raw) savedCats = JSON.parse(raw); // solo parsea si hay algo
  } catch(e) {
    console.error("Error leyendo catsInAlbum", e);
    savedCats = [];
  }

  // Filtrar los gatos de la categor√≠a actual
  currentList = (CATS[currentCat] ?? []).filter(cat => savedCats.includes(cat.catId));


  const {totalPages, items} = paginate(currentList, page, PAGE_SIZE);
  page = Math.min(page, totalPages);
  pageInfo.textContent = `P√°gina ${page}/${totalPages}`;
  prevPage.disabled = page<=1;
  nextPage.disabled = page>=totalPages;

  grid.innerHTML = "";

  if(items.length===0){
    // mostrar placeholder √∫nico cuando no hay gatos
    const card = document.createElement("div");
    card.className = "card";
    card.innerHTML = `
      <div class="placeholder">
        ${PLACEHOLDER_SVG}
      </div>
      <div class="cap">Sin gatos a√∫n‚Ä¶ <span>üîí</span></div>
    `;
    grid.appendChild(card);
    return;
  }

  items.forEach((cat,i)=>{
    const card = document.createElement("div");
    card.className = "card";
    const idxGlobal = (page-1)*PAGE_SIZE + i;

    // si no hay src, usar placeholder
    if(!cat.src){
      card.innerHTML = `
        <div class="placeholder">${PLACEHOLDER_SVG}</div>
        <div class="cap"><span>${cat.name||"Bloqueado"}</span><span>üîí</span></div>
      `;
    }else{
      card.innerHTML = `
        <img class="thumb" src="${cat.src}" alt="${cat.name??'Gato'}">
        <div class="cap"><span>${cat.name??'Gato'}</span><span>üêæ</span></div>
      `;
      card.addEventListener("click", ()=> openLightbox(idxGlobal));
    }
    grid.appendChild(card);
  });
  const currentCategoryLabel = CATEGORIES.find(c => c.id === currentCat)?.label || "";
  document.getElementById("currentCategory").textContent = currentCategoryLabel;

}

/* ============================
   Paginaci√≥n
   ============================ */
prevPage.addEventListener("click", ()=>{ if(page>1){ page--; render(); }});
nextPage.addEventListener("click", ()=>{ page++; render(); });

/* ============================
   Lightbox / Viewer
   ============================ */
const lightbox = $("#lightbox");
const fullImg = $("#fullImg");
const fullCaption = $("#fullCaption");
const btnClose = $("#btnClose");
const btnPrev = $("#btnPrev");
const btnNext = $("#btnNext");
const viewer = $("#viewer");

function openLightbox(index){
  lightIndex = index;
  updateLightbox();
  lightbox.classList.add("open");
  lightbox.setAttribute("aria-hidden","false");
}

function closeLightbox(){
  lightbox.classList.remove("open");
  lightbox.setAttribute("aria-hidden","true");
}

function updateLightbox(){
  const list = currentList;
  const item = list[lightIndex];
  if(!item){ closeLightbox(); return; }
  fullImg.src = item.src || "";
  fullCaption.textContent = item.name || "Gato";
  btnPrev.disabled = lightIndex<=0;
  btnNext.disabled = lightIndex>=list.length-1;
}

btnClose.addEventListener("click", closeLightbox);
btnPrev.addEventListener("click", ()=>{ if(lightIndex>0){ lightIndex--; updateLightbox(); }});
btnNext.addEventListener("click", ()=>{ if(lightIndex<currentList.length-1){ lightIndex++; updateLightbox(); }});
lightbox.addEventListener("click", (e)=>{ if(e.target===lightbox || e.target===viewer) closeLightbox(); });

// teclado
window.addEventListener("keydown", (e)=>{
  if(lightbox.classList.contains("open")){
    if(e.key==="Escape") closeLightbox();
    if(e.key==="ArrowLeft") btnPrev.click();
    if(e.key==="ArrowRight") btnNext.click();
  }
});

// gestos t√°ctiles
let touchStartX=null, touchEndX=null;
fullImg.addEventListener("touchstart", (e)=>{ touchStartX = e.changedTouches[0].clientX; });
fullImg.addEventListener("touchend", (e)=>{
  touchEndX = e.changedTouches[0].clientX;
  const delta = touchEndX - touchStartX;
  const TH = 40; // umbral
  if(Math.abs(delta) > TH){
    if(delta<0) btnNext.click(); else btnPrev.click();
  }
});

/* ============================
   Init
   ============================ */
makeTabs();
render();


const menuBtn = document.getElementById("menuBtn");
const menuOverlay = document.getElementById("menuOverlay");
const closeMenu = document.getElementById("closeMenu");

// Overlay empieza abierto, no hace falta abrir
menuBtn.addEventListener("click", () => {
  console.log(menuOverlay);
  menuOverlay.classList.remove("close");
});

// Bot√≥n cerrar
closeMenu.addEventListener("click", () => {
  window.location.href = "index.html";
});





</script>
</body>
</html>
